<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="utf-8">
    <title>Produkt Detaljer</title>
    <meta name="robots" content="All">
    <meta name="author" content="Udgiver">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">


</head>
<body class="bg-success-subtle">

<div class="container my-5">
    <!-- Her står overskriften og underrubriken i midten -->
    <div class="row">
        <div class="col-12 d-flex justify-content-between align-items-center">
            <i class="fa-solid fs-1 fa-arrow-left" onclick="goBack()"></i>
            <h1 class="display-4 text-center position-absolute start-50 translate-middle-x">Produkt Information</h1>
            <div class="d-flex align-items-center ms-auto">
                <i id="likeIcon" class="fa-regular fs-1 fa-heart me-3"></i>
                <a href="favoritter.html" class="btn btn-outline-dark border-3 rounded-pill">Mine favoritter</a>
            </div>
        </div>





        <div class="col-12">
            <h2 id="productName" class="mt-4 text-center"></h2>
        </div>
    </div>


    <!-- Billede og produktoplysninger i to kolonner -->
    <div class="row mt-5">
        <!-- Billede Sektion -->
        <div class="col-md-6 text-center">
            <!--  lazy loading af billeder betyder, at billeder kun indlæses, når de faktisk bliver synlige på skærmen. -->
            <img id="productImage" class="img-fluid mb-5 mb-md-5" src="" alt="Produkt Billede" loading="lazy">
        </div>

        <!-- Accordion Sektion -->
        <div class="col-md-6">
            <div class="accordion" id="accordionExample">
                <!-- Næringsindhold Accordion -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNutriments" aria-expanded="true" aria-controls="collapseNutriments">
                            Næringsindhold
                        </button>
                    </h2>
                    <div id="collapseNutriments" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <ul id="nutrimentsList">
                                <!-- Næringsindhold indsættes her via JavaScript -->
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Allergener Accordion -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAllergens" aria-expanded="false" aria-controls="collapseAllergens">
                            Allergener
                        </button>
                    </h2>
                    <div id="collapseAllergens" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <p id="allergensList">Ingen allergener tilgængelige.</p>
                        </div>
                    </div>
                </div>

                <!-- Ingredienser Accordion -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseIngredients" aria-expanded="false" aria-controls="collapseIngredients">
                            Ingredienser
                        </button>
                    </h2>
                    <div id="collapseIngredients" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <p id="ingredientsList">Ingen ingredienser tilgængelige.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script src="https://kit.fontawesome.com/e1b81ca238.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>

    // Hent data fra URL-parametre
    const params = new URLSearchParams(window.location.search);
    const productData = JSON.parse(params.get('product'));

    // Vis produktnavn og billede på siden
    document.getElementById('productName').textContent = productData.product_name;
    document.getElementById('productImage').src = productData.image_url;


    // Definer de relevante næringsstoffer, vi ønsker at vise
    const relevantNutriments = {
        'energy-kcal_100g': 'Energi (kcal)',
        'fat_100g': 'Fedt (g)',
        'saturated-fat_100g': 'Mættet fedt (g)',
        'carbohydrates_100g': 'Kulhydrater (g)',
        'sugars_100g': 'Sukker (g)',
        'fiber_100g': 'Kostfibre (g)',
        'proteins_100g': 'Protein (g)',
        'salt_100g': 'Salt (g)'
    };

    // Vis relevant næringsindhold, hvis tilgængeligt
    const nutrimentsList = document.getElementById('nutrimentsList');
    if (productData.nutriments) {
        for (const [key, value] of Object.entries(productData.nutriments)) {
            if (relevantNutriments[key]) {
                const li = document.createElement('li');
                li.textContent = `${relevantNutriments[key]}: ${value}${key.includes('_100g') ? ' (per 100g)' : ''}`;
                nutrimentsList.appendChild(li);
            }
        }
    } else {
        nutrimentsList.textContent = 'Ingen næringsindhold tilgængeligt.';
    }



    // Vis allergener
    const allergensList = document.getElementById('allergensList');
    if (productData.allergens && productData.allergens.length > 0) {
        allergensList.textContent = productData.allergens;
    } else {
        allergensList.textContent = 'Ingen allergener tilgængelige.';
    }


    // Vis ingredienser
    const ingredientsList = document.getElementById('ingredientsList');
    if (productData.ingredients_text) {
        ingredientsList.textContent = productData.ingredients_text;
    } else {
        ingredientsList.textContent = 'Ingen ingredienser tilgængelige.';
    }

    function goBack() {
        window.history.back();
    }


    // Når brugeren liker et produkt
    likeIcon.addEventListener('click', function() {
        let likedProducts = JSON.parse(localStorage.getItem('likedProducts')) || [];

        // Tjek om hjertet allerede er liket (ved at tjekke om det har klassen 'fa-solid')
        if (likeIcon.classList.contains('fa-regular')) {
            likeIcon.classList.remove('fa-regular');
            likeIcon.classList.add('fa-solid', 'text-danger');
            alert('Du har liket dette produkt!');

            // Tilføj produkt til likedProducts
            likedProducts.push(productData);
            localStorage.setItem('likedProducts', JSON.stringify(likedProducts));
        } else {
            // Hvis det allerede er liket, fjern det igen
            likeIcon.classList.remove('fa-solid', 'text-danger');
            likeIcon.classList.add('fa-regular');
            alert('Du har fjernet like på dette produkt!');

            // Fjern produkt fra likedProducts
            likedProducts = likedProducts.filter(item => item.product_name !== productData.product_name);
            localStorage.setItem('likedProducts', JSON.stringify(likedProducts));
        }
    });




</script>
</body>
</html>